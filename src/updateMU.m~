function[ par ] = updateMU( t, D, par, priors, info )

expect = getExpectations( par );

%% one t at a time
tnow = info.time == t;
tind = info.Tdatind(info.Tdat==t);

%% update
%% par.muprec(tind,:) = repmat( sum(expect.gam(:,tind),1), 1, info.G ) ...
%%     + info.N(tind) * expect.L;
par.muprec(tind,:) = expect.gam(:,tind)'*par.mship + info.N(tind) * expect.L;

%% temp1 = sum( repmat(expect.gam(:,tind),1,info.G) ...
%%     .* ( repmat(par.Fmean(:,tind)'*par.mship,info.nclus,1) ) , 1 );
temp1 = ( expect.gam(:,tind) .* par.Fmean(:,t+1) )'*par.mship;
temp2 = expect.L * sum( D(tnow,:) );

par.mumean(tind,:) = (temp1 + temp2) ./ par.muprec(tind,:);

end