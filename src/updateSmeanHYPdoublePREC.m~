function[ par ] = updateSmeanHYPdoublePREC( D, par, priors, info )

%expect = getExpectations( par );

par.SmeanHYPdoublePRECshape = priors.SmeanHYPdoulePRECshape ...
    + 0.5 + 0.5*info.nclus^2;

% SprecMat = zeros(info.nclus);
% for i = 1:info.nclus
%     SprecMat(i,:) = diag(par.Sprec{i});
% end

expSmeanMIDsq = sum(sum(par.SmeanMiddleGuymean.^2 + 1./par.SmeanMiddleGuyprec));
expSmeanHYPxSmeanHYPprior = sum(sum(par.SmeanMiddleGuymean * par.SmeanHYPmean));
expSmeanHYPpriorSq = sum(sum(par.SmeanHYPmean^2 + 1/par.SmeanHYPprec));
expSmeanHYPxSmeanHYPprior

par.SmeanHYPdoublePRECscale = priors.SmeanHYPdoublePRECscale...
    + 0.5*( expSmeanHYPsq - 2*expSmeanHYPxSmeanHYPprior + expSmeanHYPpriorSq ) ...
    + 0.5*( expSmeanMIDsq - 2*expSmeanMIDxSmeanHYP + expSmeanHYPsq );

end
