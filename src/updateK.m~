function[ par ] = updateK( t, D, par, priors, info )

expect = getExpectations( par );

size(sum(par.mship' * expect.F, 2)')
size(expect.gam)

par.Kprec = priors.Kprec + expect.gam .* sum(* expect.F, 2)';

temp = sum( expect.mu .* (par.mship' * expect.F) ,2 )';
par.Kmean = (priors.Kprec.*priors.Kmean + expect.gam .* temp) ./ par.Kprec;

end